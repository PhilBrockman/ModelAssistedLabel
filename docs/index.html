---

title: Model-assisted Labeling with YOLOv5


keywords: fastai
sidebar: home_sidebar



nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://github.com/PhilBrockman/ModelAssistedLabel/blob/master/modelassistedlabel%20splash.jpg?raw=true" alt="base64 splash"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Background">Background<a class="anchor-link" href="#Background"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>My exercise equipment doesn’t connect to a network. But I still want the "smart workout experience" when I'm using a "dumb" rowing machine.</p>
<p>If I maybe point my webcam at the equipment’s LCD output, I can make my computer interpret the digits. Perfect! I’ll just utilize object detection to determine the location and identity of digits on the machine’s readout.</p>
<p>First question -- just a tiny one -- how do you do that?</p>
<p>After wading through several guides, I found <a href="https://models.roboflow.com/object-detection/yolov5">Roboflow's YOLOv5 tutorial</a>. They provide a hands-on and accessible experience in machine learning. But unfortunately, I couldn't progress immediately on my specific project. Instead, I had to build my own dataset.</p>
<p>As I labeled digits on image after image, tedium tore at me. I envisioned using the YOLOv5 model predictions as "pre-labels". I sleuth through <a href="https://github.com/ultralytics/yolov5">Ultralytic's</a> original project, and I build wrappers around <code>detect.py</code> and <code>train.py</code>. I determine that my vision could be a reality.</p>
<p>This repository contains the tools that let me "pre-label" my images before sending them off for human inspection and correction. I also provide labeled and unlabeled images to demonstrate the tools.</p>
<ul>
<li><code>Image Repo/</code><ul>
<li><code>labeled/</code><ul>
<li><code>Final Roboflow Export (841)/</code> <ul>
<li>841 labeled image dataset</li>
</ul>
</li>
</ul>
</li>
<li><code>unlabeled/</code><ul>
<li><code>21-3-22 rowing (200) 7:50-12:50/</code><ul>
<li>200 images with direct lighting from one light source</li>
</ul>
</li>
<li><code>21-3-22 rowing (200) 1:53-7:00/</code> <ul>
<li>200 images with direct lighting from one light source and intermittent glare</li>
</ul>
</li>
<li><code>21-3-18 rowing 8-12/</code> <ul>
<li>200 images with direct light and ambient lamps turned on</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-Started">Getting Started<a class="anchor-link" href="#Getting-Started"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include tip.html content='<a href="https://colab.research.google.com/github/PhilBrockman/ModelAssistedLabel/blob/master/index.ipynb">Open In Colab</a> (and enable CPU)' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">project_name</span> <span class="o">=</span> <span class="s2">&quot;seven segment digits - &quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I back up the input files after writing them to disk just in case something breaks.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">backup_dir</span> <span class="o">=</span> <span class="s2">&quot;archive/Generation/zips&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Grab my code.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git clone https://github.com/PhilBrockman/ModelAssistedLabel.git
<span class="o">%</span><span class="k">cd</span> &quot;ModelAssistedLabel&quot;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Cloning into &#39;ModelAssistedLabel&#39;...
remote: Enumerating objects: 1023, done.
remote: Counting objects: 100% (1023/1023), done.
remote: Compressing objects: 100% (626/626), done.
remote: Total 5000 (delta 455), reused 907 (delta 359), pack-reused 3977
Receiving objects: 100% (5000/5000), 252.34 MiB | 32.54 MiB/s, done.
Resolving deltas: 100% (1478/1478), done.
Checking out files: 100% (2807/2807), done.
/content/ModelAssistedLabel
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inputs">Inputs<a class="anchor-link" href="#Inputs"> </a></h3><ul>
<li><strong>labeled images</strong><ul>
<li>All of the images and labels must be in a common folder (subfolders allowed).</li>
<li>Labels must be in <a href="https://github.com/AlexeyAB/Yolo_mark/issues/60#issuecomment-401854885">YOLOv5 format</a>.
{% include note.html content='Image/label pairs are based on their base filename. For example <code>image.jpg/image.txt</code> would be paired as would <code>other_image5.jpg/other_image5.txt</code>.' %}</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labeled_images</span> <span class="o">=</span> <span class="s2">&quot;Image Repo/labeled/Final Roboflow Export (841)&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>unlabeled images</strong></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unlabeled_images</span> <span class="o">=</span> <span class="s2">&quot;Image Repo/unlabeled/21-3-22 rowing (200) 7:50-12:50&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Output">Output<a class="anchor-link" href="#Output"> </a></h3><ul>
<li>Folder that contains: <ul>
<li><code>images/</code><ul>
<li>a copy of every image in <strong>Unlabeled Data</strong></li>
</ul>
</li>
<li><code>labels/</code><ul>
<li>result of running object detection on each image</li>
</ul>
</li>
<li><code>class labels.txt</code> to preserve the identity of the classes</li>
<li>(if training detected) a results folder produced by Ultralytic's <code>train.py</code> on the <strong>Labeled Data</strong> </li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Start by building the folder structure for the output.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ModelAssistedLabel.config</span> <span class="kn">import</span> <span class="n">Defaults</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">export_folder</span> <span class="o">=</span> <span class="n">Defaults</span><span class="o">.</span><span class="n">_itername</span><span class="p">(</span><span class="n">root_project_name</span><span class="p">)</span>

<span class="c1"># make the export folder</span>
<span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">export_folder</span><span class="p">)</span>

<span class="c1"># make the images and labels subfolders</span>
<span class="k">for</span> <span class="n">resource_folder</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;images&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">]:</span>
  <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">export_folder</span><span class="p">,</span> <span class="n">resource_folder</span><span class="p">))</span>

<span class="n">export_folder</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;seven segment digits - 1&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Configure-Defaults">Configure Defaults<a class="anchor-link" href="#Configure-Defaults"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Several values are stored by the <code>Defaults</code> class. Make sure to <code>save()</code> any changes!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Defaults</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Changing-a-Default-Value">Changing a <code>Default</code> Value<a class="anchor-link" href="#Changing-a-Default-Value"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -- Defined Keys: --&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> -- Defined Keys: --
config_file
root
split_ratio
data_yaml
resource_map
trainer_template
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Speciy the absolute path of the root directory.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pwd
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/content/ModelAssistedLabel
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="s2">&quot;/content/ModelAssistedLabel/&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Save changes and enter root directory</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">to_root</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>moving to /content/ModelAssistedLabel/
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Cloning-YOLOv5">Cloning YOLOv5<a class="anchor-link" href="#Cloning-YOLOv5"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>git clone https://github.com/ultralytics/yolov5  # clone repo

<span class="o">%</span><span class="k">cd</span> yolov5
<span class="c1"># install dependencies as necessary</span>
<span class="o">!</span>pip install -qr requirements.txt  # install dependencies <span class="o">(</span>ignore errors<span class="o">)</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">clear_output</span>  <span class="c1"># to display images</span>
<span class="kn">from</span> <span class="nn">utils.google_utils</span> <span class="kn">import</span> <span class="n">gdrive_download</span>  <span class="c1"># to download models/datasets</span>

<span class="o">%</span><span class="k">cd</span> ..
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Cloning into &#39;yolov5&#39;...
remote: Enumerating objects: 26, done.
remote: Counting objects: 100% (26/26), done.
remote: Compressing objects: 100% (25/25), done.
remote: Total 5595 (delta 7), reused 10 (delta 1), pack-reused 5569
Receiving objects: 100% (5595/5595), 8.46 MiB | 33.32 MiB/s, done.
Resolving deltas: 100% (3815/3815), done.
/content/ModelAssistedLabel/yolov5
     |████████████████████████████████| 645kB 8.0MB/s 
/content/ModelAssistedLabel
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Define-Class-Map">Define Class Map<a class="anchor-link" href="#Define-Class-Map"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(<code>data_yaml</code> value was pulled from Roboflow tutorial)</p>
<p>I have <code>nc = 10</code> classes and their <code>names</code> are all string types.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">data_yaml</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;train: ../train/images</span>
<span class="s2">val: ../valid/images</span>

<span class="s2">nc: 10</span>
<span class="s2">names: [&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;0&#39;]&quot;&quot;&quot;</span>

<span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make sure that the class names are accessible:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">get_class_names</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;0&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Store the class labels with index 0 on line 1, index 1 on line 2, and so on.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">export_folder</span><span class="p">,</span> <span class="s2">&quot;label_map.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">label_map</span><span class="p">:</span>
  <span class="n">label_map</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">get_class_names</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generating-Weights">Generating Weights<a class="anchor-link" href="#Generating-Weights"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check to see the plan for this notebook's lifespan.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
  <span class="c1">#GPU enabled and ready to train some models</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Setup complete. Using torch </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_properties</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1">#no GPU access</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Enable GPU to make predictions or train a model.&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Setup complete. Using torch 1.8.0+cu101 _CudaDeviceProperties(name=&#39;Tesla P100-PCIE-16GB&#39;, major=6, minor=0, total_memory=16280MB, multi_processor_count=56)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preparing-Filesystem">Preparing Filesystem<a class="anchor-link" href="#Preparing-Filesystem"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>Generation</code> class helps convert an unordered folder of images and labels into a format compatible with YOLOv5. By default, the train/valid/test split is set to 70%/20%/10%.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ModelAssistedLabel.fileManagement</span> <span class="kn">import</span> <span class="n">Generation</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">Generation</span><span class="p">(</span><span class="n">repo</span><span class="o">=</span><span class="n">labeled_images</span><span class="p">,</span> 
               <span class="n">out_dir</span><span class="o">=</span><span class="n">backup_dir</span><span class="p">,</span>
               <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">g</span><span class="o">.</span><span class="n">set_split</span><span class="p">()</span>
<span class="n">g</span><span class="o">.</span><span class="n">get_split</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;train&#39;: 589}, {&#39;valid&#39;: 169}, {&#39;test&#39;: 83}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Backups are built into this system. As an intermediate step, the split must be written to disk in <code>g.out_dir</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zipped</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">write_split_to_disk</span><span class="p">(</span><span class="n">descriptor</span><span class="o">=</span><span class="n">export_folder</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
dirs [&#39;./train&#39;, &#39;./valid&#39;, &#39;./test&#39;]
yaml archive/Generation/zips/Final Roboflow Export (841)seven segment digits - 1 21-03-29 17-47-41/data.yaml
subdir train
	outdir archive/Generation/zips/Final Roboflow Export (841)seven segment digits - 1 21-03-29 17-47-41
subdir valid
	outdir archive/Generation/zips/Final Roboflow Export (841)seven segment digits - 1 21-03-29 17-47-41
subdir test
	outdir archive/Generation/zips/Final Roboflow Export (841)seven segment digits - 1 21-03-29 17-47-41
os.listdir [&#39;test&#39;, &#39;data.yaml&#39;, &#39;valid&#39;, &#39;train&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, the images need to be written in a way so that the Ultralytics repository can understand their content. The <code>AutoWeights</code> class both organizes data and create weights.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ModelAssistedLabel.train</span> <span class="kn">import</span> <span class="n">AutoWeights</span>
<span class="c1">#configure a basic AutoWeights class instance</span>
<span class="n">aw</span> <span class="o">=</span> <span class="n">AutoWeights</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">export_folder</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">backup_dir</span><span class="p">)</span>

<span class="c1"># create train/valid/test split from a bag of labeled images (recusively seek out images/labels)</span>
<span class="n">aw</span><span class="o">.</span><span class="n">initialize_images_from_zip</span><span class="p">(</span><span class="n">zipped</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>mv &#39;unzipped/archive/Generation/zips/Final Roboflow Export (841)seven segment digits - 1 21-03-29 17-47-41/test&#39; .
mv &#39;unzipped/archive/Generation/zips/Final Roboflow Export (841)seven segment digits - 1 21-03-29 17-47-41/data.yaml&#39; .
mv &#39;unzipped/archive/Generation/zips/Final Roboflow Export (841)seven segment digits - 1 21-03-29 17-47-41/valid&#39; .
mv &#39;unzipped/archive/Generation/zips/Final Roboflow Export (841)seven segment digits - 1 21-03-29 17-47-41/train&#39; .
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inspect the sizes of the train/valid/test groups.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aw</span><span class="o">.</span><span class="n">traverse_resources</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>test/labels
	 &gt; 83 files
test/images
	 &gt; 83 files
File:  data.yaml
valid/labels
	 &gt; 169 files
valid/images
	 &gt; 169 files
train/labels
	 &gt; 589 files
train/images
	 &gt; 589 files
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Running-train.py-(GPU)">Running <code>train.py</code> (GPU)<a class="anchor-link" href="#Running-train.py-(GPU)"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the images written to disk, we can run the Ultralytics training algorithm. I loved watching the progress fly by in real time on the original <code>train.py</code>. Fortunately, the Ultralytics folk write the results file to disk so the model's training data is still accessible!
{% include note.html content='this output has already been calculated and stored in <code>pre-trained/results</code> for convenience.' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

&quot;Uncomment this cell to skip training.&quot;
# results_folder=&quot;pre-trained/results&quot; 

try:
  #using pretrained results
  results_folder
except NameError:
  #let the model train and find something else to do for a few hours
  aw.generate_weights(epochs=2000, yaml_data=Defaults().trainer_template)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 3s, sys: 10.8 s, total: 1min 14s
Wall time: 4h 57min 26s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;yolov5/runs/train/seven segment digits - 1/&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The results folder is stored as an attribute as well, and it has a lot of charts and images stored therein.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">aw</span><span class="o">.</span><span class="n">last_results_path</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">aw</span><span class="o">.</span><span class="n">last_results_path</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;yolov5/runs/train/seven segment digits - 1/&#39;, 22)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, the weights are stored in a subfolder called (aptly) "weights".</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">aw</span><span class="o">.</span><span class="n">last_results_path</span> <span class="o">+</span> <span class="s2">&quot;/weights&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;last.pt&#39;, &#39;best.pt&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Machine-assisted-Labeling">Machine-assisted Labeling<a class="anchor-link" href="#Machine-assisted-Labeling"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Labeling-a-New-Set-of-Images-(GPU)">Labeling a New Set of Images (GPU)<a class="anchor-link" href="#Labeling-a-New-Set-of-Images-(GPU)"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>Viewer</code> class needs weights and class labels to operate.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ModelAssistedLabel.detect</span> <span class="kn">import</span> <span class="n">Viewer</span>

<span class="c1"># access the folder of results from the AutoWeights instance</span>
<span class="n">results_folder</span> <span class="o">=</span> <span class="n">aw</span><span class="o">.</span><span class="n">last_results_path</span>

<span class="c1"># I&#39;m choosing to use the best weight.</span>
<span class="n">weight_path</span> <span class="o">=</span> <span class="n">results_folder</span> <span class="o">+</span> <span class="s2">&quot;/weights/best.pt&quot;</span>

<span class="c1"># Viewer needs a set of weights and an array of labels for the detected object types</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Viewer</span><span class="p">(</span><span class="n">weight_path</span><span class="p">,</span> <span class="n">Defaults</span><span class="p">()</span><span class="o">.</span><span class="n">get_class_names</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Fusing layers... 
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's us look through the computer's eyes at the images.</p>
<p>With the existing dataset, the model performs best under direct lighting.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline 
<span class="kn">import</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">glob</span>

<span class="n">images</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unlabeled_images</span><span class="si">}</span><span class="s2">/*.jpg&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">images</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
  <span class="n">v</span><span class="o">.</span><span class="n">plot_for</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre>Output hidden; open in https://colab.research.google.com to view.</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make predictions for all images.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
  <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">predict_for</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Predictions-Spot-Check">Predictions Spot Check<a class="anchor-link" href="#Predictions-Spot-Check"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In all 600 unlabeled images, the screen has 4 digits.</p>
<p>So lets take a look at the numbers of predictions being made:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results</span><span class="p">])</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Number of predictions per image&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Number of predictions per image&#39;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this stage in development, the YOLOv5 model could still be prone to false positives. However, I interpret the above data to suggest that there are overlapping bounding boxes that need to be resolved.</p>
<p>There are a couple of possible entry points to a programitic solution. The <code>Detector</code> class (build on top of Ultralytic's <code>detect.py</code>) has an <code>iou_threshold</code> attribute (read about <a href="https://www.pyimagesearch.com/2016/11/07/intersection-over-union-iou-for-object-detection/">Intersection Over Union</a>) that can be fiddled with. Further, in resolving overlapping bounding boxes post-hoc, I would turn to the confidence attribute stored in the <code>results</code> array.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exporting-Annotated-Images">Exporting Annotated Images<a class="anchor-link" href="#Exporting-Annotated-Images"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ensure that image/label pairs have a common root filename and collect relevant files in a single folder.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span><span class="o">,</span> <span class="nn">PIL</span><span class="o">,</span> <span class="nn">shutil</span>
<span class="n">salt</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())[</span><span class="mi">2</span><span class="p">:]</span> 

<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
  <span class="c1"># In case the salt somehow fails to be unique, forcibly generate a unique filename</span>
  <span class="n">shared_root</span> <span class="o">=</span> <span class="n">Defaults</span><span class="o">.</span><span class="n">_itername</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">salt</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

  <span class="c1">#save the image to the outfolder</span>
  <span class="n">image</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;image path&quot;</span><span class="p">])</span>
  <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">export_folder</span><span class="p">,</span> <span class="s2">&quot;images&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">shared_root</span><span class="si">}</span><span class="s2">.jpg&quot;</span><span class="p">))</span>

  <span class="c1">#save the predictions to the outfolder</span>
  <span class="n">predictions</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">export_folder</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">shared_root</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">prediction_file</span><span class="p">:</span>
    <span class="n">prediction_file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;yolov5 format&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lastly, if results need to get saved, make sure they get saved.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">moved</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#set a flag</span>

<span class="k">try</span><span class="p">:</span> 
  <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">aw</span><span class="o">.</span><span class="n">last_results_path</span><span class="p">):</span>
    <span class="c1"># `aw` exists and it has been executed </span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving yolov5 results: </span><span class="si">{</span><span class="n">aw</span><span class="o">.</span><span class="n">last_results_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">aw</span><span class="o">.</span><span class="n">last_results_path</span><span class="p">,</span> <span class="n">export_folder</span><span class="p">)</span>

    <span class="c1">#flip the flag</span>
    <span class="n">moved</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
  <span class="k">pass</span>

<span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">moved</span><span class="p">):</span>
  <span class="c1"># either the AutoWeigts didn&#39;t pan out or it wasn&#39;t used</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No weights to save&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Moving yolov5 results: yolov5/runs/train/seven segment digits - 1/
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">export_folder</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;seven segment digits - 1&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I labeled dozens upon dozens and dozens of images with Roboflow and would recommend their free annotation service! However, to be transparent, I developed <a href="https://github.com/PhilBrockman/autobbox">an annotator</a> in React that better suited my physical needs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-up-an-Image-Set">Building up an Image Set<a class="anchor-link" href="#Building-up-an-Image-Set"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Keep in mind the <code>Generation</code> class recursively finds all images and lables. So as long as the newly annotated images and the original Image Set are in the same folder, <code>Generation</code>'s constructor function will find them.</p>
<p>And every time <code>Generation</code> calls a <code>split_to_disk</code> that split is archived in <code>backup_dir</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Wrap-Up">Wrap Up<a class="anchor-link" href="#Wrap-Up"> </a></h2><p>I have uncovered a camera and lighting positioning that allows for my model to read the LCD at with high fidelty. I'm using object detection as a form of OCR and it's working!</p>
<p>I see three main areas for development with this project. The first would be bolstering the dataset (and staying in the machine learning space). The second would be logic interpreting parsed data (building the "smart" software).</p>
<p>The third area of development is refactoring. I made a decision early on to hard to hardcode the path to training and validation images. It's worth revisiting the way <code>Defaults.data_yaml</code> is constructed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Note-on-the-Image-Set">Note on the Image Set<a class="anchor-link" href="#Note-on-the-Image-Set"> </a></h3><p>This dataset of 841 images is a mishmash. There's images from a different rowing machine and also from  <a href="https://github.com/SachaIZADI/Seven-Segment-OCR">this</a> repo. Some scenes are illuminated with sunlight. Others have been cropped to include only the LCD. Digits like 7, 8, and 9 are underrepresented.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Recording-from-Laptop">Recording from Laptop<a class="anchor-link" href="#Recording-from-Laptop"> </a></h3><p>This is my setup for how I'm currently fixing the position my black-shelled laptop while recording: <a href="https://raw.githubusercontent.com/PhilBrockman/ModelAssistedLabel/master/DIY-laptop-mount.jpg">pic1</a>, <a href="https://raw.githubusercontent.com/PhilBrockman/ModelAssistedLabel/master/DIY-computer-capture.jpg">pic2</a>, <a href="https://github.com/PhilBrockman/ModelAssistedLabel/blob/master/DIY-capture.jpeg?raw=true">pic3</a>.</p>
<p>I use the <code>_capture.ipynb</code> notebook to capture images on a bit of a delay to prevent repeat images from cluttering the dataset. For me, it was much easier to get recording working from a local notebook than from a Colab notebook but YMMV.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="About-Me">About Me<a class="anchor-link" href="#About-Me"> </a></h3><p>I am finishing my fourth year as a public school teacher in Kentucky. This summer, I am moving to the Bay Area to pursue a career in tech. When I’m not coding, I enjoy playing violin! Reach me at phil.brockman@gmail.com.</p>

</div>
</div>
</div>
</div>
 

